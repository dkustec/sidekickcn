{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "sidekick-floating",
  "type": "registry:component",
  "title": "sidekick/cn Floating Widget",
  "description": "Floating chat widget (50vh) with clean design, ScrollArea, and keyboard shortcuts",
  "dependencies": [
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "scroll-area",
    "https://sidekickcn-one.vercel.app/r/sidekick-provider.json",
    "https://sidekickcn-one.vercel.app/r/ai-elements-message.json",
    "https://sidekickcn-one.vercel.app/r/ai-elements-prompt-input.json",
    "https://sidekickcn-one.vercel.app/r/ai-elements-shimmer.json"
  ],
  "files": [
    {
      "path": "src/components/sidekick/sidekick-floating.tsx",
      "content": "\"use client\";\n\nimport {\n  Message,\n  MessageContent,\n  MessageResponse,\n} from \"@/components/ai-elements/message\";\nimport {\n  PromptInput,\n  PromptInputBody,\n  PromptInputFooter,\n  PromptInputSubmit,\n  PromptInputTextarea,\n  PromptInputTools,\n} from \"@/components/ai-elements/prompt-input\";\nimport { ShimmerLines } from \"@/components/ai-elements/shimmer\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { cn } from \"@/lib/utils\";\nimport { MessageSquareIcon, MinusIcon, X } from \"lucide-react\";\nimport * as React from \"react\";\nimport { useSidekick } from \"./sidekick-provider\";\n\ntype SidekickFloatingProps = {\n  position?: \"bottom-right\" | \"bottom-left\" | \"top-right\" | \"top-left\";\n  defaultOpen?: boolean;\n  trigger?: React.ReactNode;\n  className?: string;\n};\n\nexport function SidekickFloating({\n  position = \"bottom-right\",\n  defaultOpen = false,\n  trigger,\n  className,\n}: SidekickFloatingProps) {\n  const [isOpen, setIsOpen] = React.useState(defaultOpen);\n  const [isMinimized, setIsMinimized] = React.useState(false);\n  const { messages, addMessage, sendPrompt, isLoading } = useSidekick();\n  const [text, setText] = React.useState(\"\");\n  const scrollRef = React.useRef<HTMLDivElement>(null);\n\n  const positionClasses = {\n    \"bottom-right\": \"bottom-6 right-6\",\n    \"bottom-left\": \"bottom-6 left-6\",\n    \"top-right\": \"top-6 right-6\",\n    \"top-left\": \"top-6 left-6\",\n  };\n\n  React.useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if ((e.metaKey || e.ctrlKey) && e.key === \"k\") {\n        e.preventDefault();\n        setIsOpen((prev) => !prev);\n      }\n      if (e.key === \"Escape\" && isOpen) {\n        e.preventDefault();\n        setIsOpen(false);\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isOpen]);\n\n  React.useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  const handleSubmit = React.useCallback(\n    async ({ text }: { text: string; attachments?: File[] }) => {\n      if (!text.trim() || isLoading) return;\n\n      addMessage({ role: \"user\", content: text });\n      setText(\"\");\n\n      try {\n        const response = await sendPrompt(text);\n        addMessage({ role: \"assistant\", content: response });\n      } catch (error) {\n        addMessage({\n          role: \"assistant\",\n          content: \"Sorry, I encountered an error processing your request.\",\n        });\n      }\n    },\n    [isLoading, addMessage, sendPrompt],\n  );\n\n  return (\n    <>\n      {!isOpen && (\n        <div className={cn(\"fixed z-50\", positionClasses[position])}>\n          {trigger || (\n            <Button\n              size=\"lg\"\n              className=\"h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 touch-manipulation -webkit-tap-highlight-color-transparent\"\n              onClick={() => setIsOpen(true)}\n              aria-label=\"Open sidekick/cn (⌘K)\"\n            >\n              <MessageSquareIcon className=\"h-6 w-6\" aria-hidden=\"true\" />\n              <span className=\"sr-only\">Open sidekick/cn (⌘K)</span>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {isOpen && (\n        <div\n          className={cn(\n            \"fixed z-50 flex flex-col rounded-xl border bg-background shadow-2xl transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 motion-reduce:transition-none\",\n            isMinimized ? \"h-12\" : \"h-[50vh] sm:h-[60vh]\",\n            \"w-[95vw] sm:w-[90vw] max-w-[420px]\",\n            positionClasses[position],\n            className,\n          )}\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"sidekick-title\"\n          aria-describedby=\"sidekick-description\"\n        >\n          <div className=\"flex items-center justify-between border-b px-4 py-2.5 bg-muted/30 backdrop-blur-sm rounded-t-xl\">\n            <div className=\"flex items-center gap-2\">\n              <MessageSquareIcon\n                className=\"h-4 w-4 text-primary\"\n                aria-hidden=\"true\"\n              />\n              <span id=\"sidekick-title\" className=\"text-sm font-semibold\">\n                sidekick/cn\n              </span>\n              <span id=\"sidekick-description\" className=\"sr-only\">\n                AI assistant chat interface\n              </span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-7 w-7 hover:bg-muted focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-1\"\n                onClick={() => setIsMinimized(!isMinimized)}\n                aria-label={isMinimized ? \"Expand chat\" : \"Minimize chat\"}\n              >\n                <MinusIcon className=\"h-3.5 w-3.5\" aria-hidden=\"true\" />\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-7 w-7 hover:bg-muted focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-1\"\n                onClick={() => setIsOpen(false)}\n                aria-label=\"Close chat\"\n              >\n                <X className=\"h-3.5 w-3.5\" aria-hidden=\"true\" />\n              </Button>\n            </div>\n          </div>\n\n          {!isMinimized && (\n            <div className=\"flex flex-col flex-1 min-h-0\">\n              <ScrollArea className=\"flex-1 px-4\" ref={scrollRef}>\n                <div className=\"flex flex-col gap-3 py-4\">\n                  {messages.length === 0 && (\n                    <Message from=\"assistant\">\n                      <MessageContent>\n                        <MessageResponse>\n                          Hi! I'm sidekick/cn. How can I help you today?\n                        </MessageResponse>\n                      </MessageContent>\n                    </Message>\n                  )}\n                  {messages.map((message) => (\n                    <Message from={message.role} key={message.id}>\n                      <MessageContent>\n                        <MessageResponse>{message.content}</MessageResponse>\n                      </MessageContent>\n                    </Message>\n                  ))}\n                  {isLoading && (\n                    <Message from=\"assistant\">\n                      <MessageContent>\n                        <ShimmerLines lines={2} />\n                      </MessageContent>\n                    </Message>\n                  )}\n                </div>\n              </ScrollArea>\n\n              <div className=\"shrink-0 p-3 border-t bg-muted/20\">\n                <PromptInput onSubmit={handleSubmit}>\n                  <PromptInputBody>\n                    <PromptInputTextarea\n                      placeholder=\"Ask me anything...\"\n                      onChange={(event) => setText(event.target.value)}\n                      value={text}\n                      className=\"min-h-[44px] max-h-[80px]\"\n                    />\n                  </PromptInputBody>\n                  <PromptInputFooter className=\"pt-2\">\n                    <PromptInputTools />\n                    <PromptInputSubmit />\n                  </PromptInputFooter>\n                </PromptInput>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}


